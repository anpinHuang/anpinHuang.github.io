<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Predicting Churns</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-DH9DRW0BMM"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-DH9DRW0BMM');
</script>


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-222711575-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-222711575-1');
</script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Ben Huang</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About me</a>
</li>
<li>
  <a href="econometrics.html">Econometrics</a>
</li>
<li>
  <a href="dataScienceML.html">Data Science</a>
</li>
<li>
  <a href="Finance.html">Financial Math &amp; Credit Models</a>
</li>
<li>
  <a href="Programming.html">Programming</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Predicting Churns</h1>

</div>


<p>The purpose of this section is to use tree-based algorithm to predict churn of a customr based on some explanatory variable. The data I use is the Customer Support data from <a href="https://www.ibm.com/communities/analytics/watson-analytics-blog/guide-to-sample-datasets/">IBM Watson Analytics</a>.</p>
<pre class="r"><code>library(survival)
library(ggfortify)
library(rpart)
library(dplyr)</code></pre>
<pre class="r"><code>churnAnalysis &lt;- read.csv(&quot;WA_Fn-UseC_-Telco-Customer-Churn.csv&quot;) 
churnAnalysis &lt;- as.data.frame(churnAnalysis)
#head(churnAnalysis)</code></pre>
<p>   </p>
<div id="data-pre-processing" class="section level3">
<h3>1. Data pre-processing</h3>
<p>Check if there is missing value. There are only 11 missing values in TotalCharges so we can just remove entire row given that the number is small.</p>
<pre class="r"><code>sapply(churnAnalysis, function(x) sum(is.na(x)))</code></pre>
<pre><code>##       customerID           gender    SeniorCitizen          Partner 
##                0                0                0                0 
##       Dependents           tenure     PhoneService    MultipleLines 
##                0                0                0                0 
##  InternetService   OnlineSecurity     OnlineBackup DeviceProtection 
##                0                0                0                0 
##      TechSupport      StreamingTV  StreamingMovies         Contract 
##                0                0                0                0 
## PaperlessBilling    PaymentMethod   MonthlyCharges     TotalCharges 
##                0                0                0               11 
##            Churn 
##                0</code></pre>
<pre class="r"><code>churnAnalysis &lt;- churnAnalysis[which(!is.na(churnAnalysis[,&quot;TotalCharges&quot;])),]</code></pre>
<p>Then we look at what variables are continuous, and they are: “tenure”, “MonthlyCharges” and “TotalCharges”</p>
</div>
<div id="kaplan-meier-analysis" class="section level3">
<h3>2. Kaplan Meier Analysis</h3>
<pre class="r"><code>library(survival)
library(ggfortify)
churnAnalysis &lt;- churnAnalysis %&gt;% mutate(Churn_flag = ifelse(Churn==&quot;Yes&quot;, 1, 0) )
km_churn &lt;- with(churnAnalysis, Surv(tenure, Churn_flag))
km_fit &lt;- survfit(Surv(tenure, Churn_flag) ~ 1, data=churnAnalysis)
autoplot(km_fit)</code></pre>
<p><img src="Churn_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>The figure below shows the conditional churn probability given that the account “survived” the last period. We can see that the churn rate is the highest in the first time unit and gradually reverts to the mean at around 10th time unit.</p>
<pre class="r"><code># Conditional churn probability
s0 &lt;- c(1,km_fit$surv[1:71])
c &lt;- (1-km_fit$surv)/s0
c &lt;- (s0-km_fit$surv)/s0
plot(c, type=&#39;l&#39;)</code></pre>
<p><img src="Churn_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<pre class="r"><code>km_fit_bill &lt;- survfit(Surv(tenure, Churn_flag) ~ PaperlessBilling, data=churnAnalysis)
autoplot(km_fit_bill)</code></pre>
<p><img src="Churn_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<pre class="r"><code>km_fit_senior &lt;- survfit(Surv(tenure, Churn_flag) ~ SeniorCitizen, data=churnAnalysis)
autoplot(km_fit_senior)</code></pre>
<p><img src="Churn_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<pre class="r"><code>km_fit_pay &lt;- survfit(Surv(tenure, Churn_flag) ~ PaymentMethod, data=churnAnalysis)
autoplot(km_fit_pay)</code></pre>
<p><img src="Churn_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
</div>
<div id="information-value" class="section level3">
<h3>3. Information value</h3>
<pre><code>## 
## Attaching package: &#39;kableExtra&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     group_rows</code></pre>
<table class="table" style="width: auto !important; float: left; margin-right: 10px;">
<thead>
<tr>
<th style="text-align:left;">
Variable
</th>
<th style="text-align:right;">
IV
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Contract
</td>
<td style="text-align:right;">
1.2331890
</td>
</tr>
<tr>
<td style="text-align:left;">
tenure
</td>
<td style="text-align:right;">
0.8347032
</td>
</tr>
<tr>
<td style="text-align:left;">
OnlineSecurity
</td>
<td style="text-align:right;">
0.7152919
</td>
</tr>
<tr>
<td style="text-align:left;">
TechSupport
</td>
<td style="text-align:right;">
0.6971084
</td>
</tr>
<tr>
<td style="text-align:left;">
InternetService
</td>
<td style="text-align:right;">
0.6152530
</td>
</tr>
<tr>
<td style="text-align:left;">
OnlineBackup
</td>
<td style="text-align:right;">
0.5264879
</td>
</tr>
<tr>
<td style="text-align:left;">
DeviceProtection
</td>
<td style="text-align:right;">
0.4976099
</td>
</tr>
<tr>
<td style="text-align:left;">
PaymentMethod
</td>
<td style="text-align:right;">
0.4557558
</td>
</tr>
<tr>
<td style="text-align:left;">
StreamingMovies
</td>
<td style="text-align:right;">
0.3798511
</td>
</tr>
<tr>
<td style="text-align:left;">
StreamingTV
</td>
<td style="text-align:right;">
0.3787158
</td>
</tr>
</tbody>
</table>
<table class="table" style="width: auto !important; ">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
Variable
</th>
<th style="text-align:right;">
IV
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
11
</td>
<td style="text-align:left;">
MonthlyCharges
</td>
<td style="text-align:right;">
0.3631453
</td>
</tr>
<tr>
<td style="text-align:left;">
12
</td>
<td style="text-align:left;">
TotalCharges
</td>
<td style="text-align:right;">
0.3376950
</td>
</tr>
<tr>
<td style="text-align:left;">
13
</td>
<td style="text-align:left;">
PaperlessBilling
</td>
<td style="text-align:right;">
0.2020563
</td>
</tr>
<tr>
<td style="text-align:left;">
14
</td>
<td style="text-align:left;">
Dependents
</td>
<td style="text-align:right;">
0.1531686
</td>
</tr>
<tr>
<td style="text-align:left;">
15
</td>
<td style="text-align:left;">
Partner
</td>
<td style="text-align:right;">
0.1178772
</td>
</tr>
<tr>
<td style="text-align:left;">
16
</td>
<td style="text-align:left;">
SeniorCitizen
</td>
<td style="text-align:right;">
0.1050842
</td>
</tr>
<tr>
<td style="text-align:left;">
17
</td>
<td style="text-align:left;">
MultipleLines
</td>
<td style="text-align:right;">
0.0081689
</td>
</tr>
<tr>
<td style="text-align:left;">
18
</td>
<td style="text-align:left;">
PhoneService
</td>
<td style="text-align:right;">
0.0007129
</td>
</tr>
<tr>
<td style="text-align:left;">
19
</td>
<td style="text-align:left;">
gender
</td>
<td style="text-align:right;">
0.0003741
</td>
</tr>
<tr>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
</tbody>
</table>
</div>
<div id="logistic-regression-with-woes" class="section level3">
<h3>4. logistic regression with WOEs</h3>
<p>Under contruction</p>
</div>
<div id="decision-tree-by-rpart" class="section level3">
<h3>5. Decision tree by rpart</h3>
<p>To use decision tree, we need to convert the continuous variables to categorical variables be setting some thresold. But first, let’s split the data into training, validation and test sets.</p>
<pre class="r"><code>## randomize the data first
churnAnalysis &lt;- churnAnalysis[sample(1:nrow(churnAnalysis)),]
## then split
churnAnalysisTraining &lt;- churnAnalysis[1:(nrow(churnAnalysis)/2),]
churnAnalysisValidation &lt;- churnAnalysis[(nrow(churnAnalysis)/2+1): (3*nrow(churnAnalysis)/4),]
churnAnalysisTest &lt;- churnAnalysis[(3*nrow(churnAnalysis)/4+1),nrow(churnAnalysis),]</code></pre>
<pre class="r"><code>hist(churnAnalysisTraining[,&quot;MonthlyCharges&quot;],breaks=40)</code></pre>
<p><img src="Churn_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<pre class="r"><code>MonthlyChargesClass &lt;- ifelse(churnAnalysis[,&quot;MonthlyCharges&quot;]&lt;=30,&quot;&lt;=$30&quot;,&quot;&gt;30$&quot;)</code></pre>
<p>As the distribtion of “MonthlyCharges” does look like normal distribution and there seems to be a spike for monthly charges under 30. Hence, I try to split the data into 2:<br />
1. monthly charges $ 30 $<br />
2. monthly charges $ &gt; 30 $</p>
<pre class="r"><code>hist(churnAnalysisTraining[,&quot;TotalCharges&quot;],breaks=40)</code></pre>
<p><img src="Churn_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<pre class="r"><code>TotalChargesClass &lt;- ifelse(churnAnalysis[,&quot;TotalCharges&quot;]&lt;=500,&quot;&lt;=$500&quot;,&quot;&gt;500$&quot;)</code></pre>
<pre class="r"><code>hist(churnAnalysisTraining[,&quot;tenure&quot;],breaks=80)</code></pre>
<p><img src="Churn_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<pre class="r"><code>TenureClass &lt;- churnAnalysis[,&quot;tenure&quot;]
TenureClass[which(churnAnalysis[,&quot;tenure&quot;] &gt;=70)] &lt;- &quot;&gt;=70&quot;
TenureClass[which(churnAnalysis[,&quot;tenure&quot;] &lt;=5)] &lt;- &quot;&lt;=5&quot;
TenureClass[which(churnAnalysis[,&quot;tenure&quot;] &gt;5 &amp; churnAnalysis[,&quot;tenure&quot;] &lt;70)] &lt;- &quot;between&quot;</code></pre>
<p>Apply the class transform to all 3 data sets</p>
<pre class="r"><code>churnAnalysis[&quot;MonthlyCharges&quot;] &lt;- MonthlyChargesClass
churnAnalysis[&quot;TotalCharges&quot;] &lt;- TotalChargesClass
churnAnalysis[&quot;tenure&quot;] &lt;- TenureClass
churnAnalysisTraining &lt;- churnAnalysis[1:(nrow(churnAnalysis)/2),]
churnAnalysisValidation &lt;- churnAnalysis[(nrow(churnAnalysis)/2+1): floor(3*nrow(churnAnalysis)/4),]
churnAnalysisTest &lt;- churnAnalysis[floor(3*nrow(churnAnalysis)/4+1):nrow(churnAnalysis),]</code></pre>
<hr />
<hr />
<p>use rpart to run decision tree from package:rpart</p>
<pre class="r"><code>library(rpart)
## xval determine how many data points you want in the validation set.
fitTree &lt;- rpart(Churn~gender+SeniorCitizen+Partner+Dependents+tenure+PhoneService+MultipleLines+InternetService+OnlineSecurity+OnlineBackup+DeviceProtection+TechSupport+StreamingTV+StreamingMovies+Contract+PaperlessBilling+PaymentMethod+MonthlyCharges+TotalCharges, churnAnalysisTraining,xval=0) 
pred_fitTree &lt;- predict(fitTree, churnAnalysisTest,type=&quot;class&quot;)
table(Predicted = pred_fitTree, Actual = churnAnalysisTest$Churn) ## Confusion Matrix for Decision Tree</code></pre>
<pre><code>##          Actual
## Predicted   No  Yes
##       No  1193  290
##       Yes  108  167</code></pre>
<pre class="r"><code>plot(fitTree,uniform=TRUE)
text(fitTree,use.n=T,all=T)</code></pre>
<p><img src="Churn_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<pre class="r"><code>printcp(fitTree) ## cp : complexity parameter</code></pre>
<pre><code>## 
## Classification tree:
## rpart(formula = Churn ~ gender + SeniorCitizen + Partner + Dependents + 
##     tenure + PhoneService + MultipleLines + InternetService + 
##     OnlineSecurity + OnlineBackup + DeviceProtection + TechSupport + 
##     StreamingTV + StreamingMovies + Contract + PaperlessBilling + 
##     PaymentMethod + MonthlyCharges + TotalCharges, data = churnAnalysisTraining, 
##     xval = 0)
## 
## Variables actually used in tree construction:
## [1] Contract        InternetService MultipleLines   OnlineSecurity 
## [5] PaymentMethod   tenure         
## 
## Root node error: 939/3516 = 0.26706
## 
## n= 3516 
## 
##         CP nsplit rel error
## 1 0.060170      0   1.00000
## 2 0.047923      2   0.87966
## 3 0.026624      3   0.83174
## 4 0.025559      4   0.80511
## 5 0.013845      5   0.77955
## 6 0.010000      6   0.76571</code></pre>
<p>The cp at row one is the (rel error at row 2 - rel error at row 1)/nsplit in row 2. The “rel error” is the relative error = absolute error/root node error</p>
<hr />
<p>now prune the tree using the validation set</p>
<pre class="r"><code>TreeDepth &lt;- nrow(fitTree$cptable)
for(i in 2:TreeDepth)


printcp(fitTree)</code></pre>
<pre><code>## 
## Classification tree:
## rpart(formula = Churn ~ gender + SeniorCitizen + Partner + Dependents + 
##     tenure + PhoneService + MultipleLines + InternetService + 
##     OnlineSecurity + OnlineBackup + DeviceProtection + TechSupport + 
##     StreamingTV + StreamingMovies + Contract + PaperlessBilling + 
##     PaymentMethod + MonthlyCharges + TotalCharges, data = churnAnalysisTraining, 
##     xval = 0)
## 
## Variables actually used in tree construction:
## [1] Contract        InternetService MultipleLines   OnlineSecurity 
## [5] PaymentMethod   tenure         
## 
## Root node error: 939/3516 = 0.26706
## 
## n= 3516 
## 
##         CP nsplit rel error
## 1 0.060170      0   1.00000
## 2 0.047923      2   0.87966
## 3 0.026624      3   0.83174
## 4 0.025559      4   0.80511
## 5 0.013845      5   0.77955
## 6 0.010000      6   0.76571
## 
## Classification tree:
## rpart(formula = Churn ~ gender + SeniorCitizen + Partner + Dependents + 
##     tenure + PhoneService + MultipleLines + InternetService + 
##     OnlineSecurity + OnlineBackup + DeviceProtection + TechSupport + 
##     StreamingTV + StreamingMovies + Contract + PaperlessBilling + 
##     PaymentMethod + MonthlyCharges + TotalCharges, data = churnAnalysisTraining, 
##     xval = 0)
## 
## Variables actually used in tree construction:
## [1] Contract        InternetService MultipleLines   OnlineSecurity 
## [5] PaymentMethod   tenure         
## 
## Root node error: 939/3516 = 0.26706
## 
## n= 3516 
## 
##         CP nsplit rel error
## 1 0.060170      0   1.00000
## 2 0.047923      2   0.87966
## 3 0.026624      3   0.83174
## 4 0.025559      4   0.80511
## 5 0.013845      5   0.77955
## 6 0.010000      6   0.76571
## 
## Classification tree:
## rpart(formula = Churn ~ gender + SeniorCitizen + Partner + Dependents + 
##     tenure + PhoneService + MultipleLines + InternetService + 
##     OnlineSecurity + OnlineBackup + DeviceProtection + TechSupport + 
##     StreamingTV + StreamingMovies + Contract + PaperlessBilling + 
##     PaymentMethod + MonthlyCharges + TotalCharges, data = churnAnalysisTraining, 
##     xval = 0)
## 
## Variables actually used in tree construction:
## [1] Contract        InternetService MultipleLines   OnlineSecurity 
## [5] PaymentMethod   tenure         
## 
## Root node error: 939/3516 = 0.26706
## 
## n= 3516 
## 
##         CP nsplit rel error
## 1 0.060170      0   1.00000
## 2 0.047923      2   0.87966
## 3 0.026624      3   0.83174
## 4 0.025559      4   0.80511
## 5 0.013845      5   0.77955
## 6 0.010000      6   0.76571
## 
## Classification tree:
## rpart(formula = Churn ~ gender + SeniorCitizen + Partner + Dependents + 
##     tenure + PhoneService + MultipleLines + InternetService + 
##     OnlineSecurity + OnlineBackup + DeviceProtection + TechSupport + 
##     StreamingTV + StreamingMovies + Contract + PaperlessBilling + 
##     PaymentMethod + MonthlyCharges + TotalCharges, data = churnAnalysisTraining, 
##     xval = 0)
## 
## Variables actually used in tree construction:
## [1] Contract        InternetService MultipleLines   OnlineSecurity 
## [5] PaymentMethod   tenure         
## 
## Root node error: 939/3516 = 0.26706
## 
## n= 3516 
## 
##         CP nsplit rel error
## 1 0.060170      0   1.00000
## 2 0.047923      2   0.87966
## 3 0.026624      3   0.83174
## 4 0.025559      4   0.80511
## 5 0.013845      5   0.77955
## 6 0.010000      6   0.76571
## 
## Classification tree:
## rpart(formula = Churn ~ gender + SeniorCitizen + Partner + Dependents + 
##     tenure + PhoneService + MultipleLines + InternetService + 
##     OnlineSecurity + OnlineBackup + DeviceProtection + TechSupport + 
##     StreamingTV + StreamingMovies + Contract + PaperlessBilling + 
##     PaymentMethod + MonthlyCharges + TotalCharges, data = churnAnalysisTraining, 
##     xval = 0)
## 
## Variables actually used in tree construction:
## [1] Contract        InternetService MultipleLines   OnlineSecurity 
## [5] PaymentMethod   tenure         
## 
## Root node error: 939/3516 = 0.26706
## 
## n= 3516 
## 
##         CP nsplit rel error
## 1 0.060170      0   1.00000
## 2 0.047923      2   0.87966
## 3 0.026624      3   0.83174
## 4 0.025559      4   0.80511
## 5 0.013845      5   0.77955
## 6 0.010000      6   0.76571</code></pre>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
